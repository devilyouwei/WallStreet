{"code":"import * as tslib_1 from \"tslib\";\r\nimport * as tfc from '@tensorflow/tfjs-core';\r\nimport { serialization, tidy } from '@tensorflow/tfjs-core';\r\nimport { imageDataFormat } from '../backend/common';\r\nimport { InputSpec, Layer } from '../engine/topology';\r\nimport { ValueError } from '../errors';\r\nimport { getExactlyOneShape, getExactlyOneTensor } from '../utils/generic_utils';\r\nexport function temporalPadding(x, padding) {\r\n    return tidy(function () {\r\n        if (x.rank !== 3) {\r\n            throw new ValueError(\"temporalPadding expects input tensor to be 3-D, but received a \" +\r\n                (x.rank + \"-D tensor.\"));\r\n        }\r\n        if (padding == null) {\r\n            padding = [1, 1];\r\n        }\r\n        if (padding.length !== 2) {\r\n            throw new ValueError(\"temporalPadding expects input padding pattern to be a length-2 \" +\r\n                (\"array, but received a length-\" + padding.length + \" array.\"));\r\n        }\r\n        var pattern = [[0, 0], padding, [0, 0]];\r\n        return tfc.pad(x, pattern);\r\n    });\r\n}\r\nexport function spatial2dPadding(x, padding, dataFormat) {\r\n    return tidy(function () {\r\n        if (x.rank !== 4) {\r\n            throw new ValueError(\"temporalPadding expects input tensor to be 4-D, but received a \" +\r\n                (x.rank + \"-D tensor.\"));\r\n        }\r\n        if (padding == null) {\r\n            padding = [[1, 1], [1, 1]];\r\n        }\r\n        if (padding.length !== 2 || padding[0].length !== 2 ||\r\n            padding[1].length !== 2) {\r\n            throw new ValueError('spatial2dPadding expects `padding` to be an Array of two Arrays, ' +\r\n                'each of which is an Array of two integers.');\r\n        }\r\n        if (dataFormat == null) {\r\n            dataFormat = imageDataFormat();\r\n        }\r\n        if (dataFormat !== 'channelsLast' && dataFormat !== 'channelsFirst') {\r\n            throw new ValueError(\"Unknown data format: \" + dataFormat + \". \" +\r\n                \"Supported data formats are 'channelsLast' and 'channelsFirst.\");\r\n        }\r\n        var pattern;\r\n        if (dataFormat === 'channelsFirst') {\r\n            pattern = [[0, 0], [0, 0], padding[0], padding[1]];\r\n        }\r\n        else {\r\n            pattern = [[0, 0], padding[0], padding[1], [0, 0]];\r\n        }\r\n        return tfc.pad(x, pattern);\r\n    });\r\n}\r\nvar ZeroPadding2D = (function (_super) {\r\n    tslib_1.__extends(ZeroPadding2D, _super);\r\n    function ZeroPadding2D(config) {\r\n        var _this = this;\r\n        if (config == null) {\r\n            config = {};\r\n        }\r\n        _this = _super.call(this, config) || this;\r\n        _this.dataFormat =\r\n            config.dataFormat == null ? imageDataFormat() : config.dataFormat;\r\n        if (config.padding == null) {\r\n            _this.padding = [[1, 1], [1, 1]];\r\n        }\r\n        else if (typeof config.padding === 'number') {\r\n            _this.padding =\r\n                [[config.padding, config.padding], [config.padding, config.padding]];\r\n        }\r\n        else {\r\n            config.padding = config.padding;\r\n            if (config.padding.length !== 2) {\r\n                throw new ValueError(\"ZeroPadding2D expects padding to be a length-2 array, but \" +\r\n                    (\"received a length-\" + config.padding.length + \" array.\"));\r\n            }\r\n            var heightPadding = void 0;\r\n            var widthPadding = void 0;\r\n            if (typeof config.padding[0] === 'number') {\r\n                heightPadding =\r\n                    [config.padding[0], config.padding[0]];\r\n                widthPadding =\r\n                    [config.padding[1], config.padding[1]];\r\n            }\r\n            else {\r\n                config.padding = config.padding;\r\n                if (config.padding[0].length !== 2) {\r\n                    throw new ValueError(\"ZeroPadding2D expects height padding to be a length-2 array, \" +\r\n                        (\"but received a length-\" + config.padding[0].length + \" array.\"));\r\n                }\r\n                heightPadding = config.padding[0];\r\n                if (config.padding[1].length !== 2) {\r\n                    throw new ValueError(\"ZeroPadding2D expects width padding to be a length-2 array, \" +\r\n                        (\"but received a length-\" + config.padding[1].length + \" array.\"));\r\n                }\r\n                widthPadding = config.padding[1];\r\n            }\r\n            _this.padding = [heightPadding, widthPadding];\r\n        }\r\n        _this.inputSpec = [new InputSpec({ ndim: 4 })];\r\n        return _this;\r\n    }\r\n    ZeroPadding2D.prototype.computeOutputShape = function (inputShape) {\r\n        inputShape = getExactlyOneShape(inputShape);\r\n        var rows;\r\n        var cols;\r\n        if (this.dataFormat === 'channelsFirst') {\r\n            if (inputShape[2] != null && inputShape[2] >= 0) {\r\n                rows = inputShape[2] + this.padding[0][0] + this.padding[0][1];\r\n            }\r\n            else {\r\n                rows = null;\r\n            }\r\n            if (inputShape[3] != null && inputShape[3] >= 0) {\r\n                cols = inputShape[3] + this.padding[1][0] + this.padding[1][1];\r\n            }\r\n            else {\r\n                cols = null;\r\n            }\r\n            return [inputShape[0], inputShape[1], rows, cols];\r\n        }\r\n        else {\r\n            if (inputShape[1] != null && inputShape[1] >= 0) {\r\n                rows = inputShape[1] + this.padding[0][0] + this.padding[0][1];\r\n            }\r\n            else {\r\n                rows = null;\r\n            }\r\n            if (inputShape[2] != null && inputShape[2] >= 0) {\r\n                cols = inputShape[2] + this.padding[1][0] + this.padding[1][1];\r\n            }\r\n            else {\r\n                cols = null;\r\n            }\r\n            return [inputShape[0], rows, cols, inputShape[3]];\r\n        }\r\n    };\r\n    ZeroPadding2D.prototype.call = function (inputs, kwargs) {\r\n        var _this = this;\r\n        return tidy(function () { return spatial2dPadding(getExactlyOneTensor(inputs), _this.padding, _this.dataFormat); });\r\n    };\r\n    ZeroPadding2D.prototype.getConfig = function () {\r\n        var config = {\r\n            padding: this.padding,\r\n            dataFormat: this.dataFormat,\r\n        };\r\n        var baseConfig = _super.prototype.getConfig.call(this);\r\n        Object.assign(config, baseConfig);\r\n        return config;\r\n    };\r\n    ZeroPadding2D.className = 'ZeroPadding2D';\r\n    return ZeroPadding2D;\r\n}(Layer));\r\nexport { ZeroPadding2D };\r\nserialization.SerializationMap.register(ZeroPadding2D);\r\n//# sourceMappingURL=padding.js.map","map":"{\"version\":3,\"file\":\"padding.js\",\"sourceRoot\":\"\",\"sources\":[\"../src/layers/padding.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/usr/local/google/home/smilkov/code/tfjs-layers/layers/padding.d.ts","text":"import { serialization, Tensor } from '@tensorflow/tfjs-core';\r\nimport { DataFormat } from '../common';\r\nimport { Layer, LayerConfig } from '../engine/topology';\r\nimport { Kwargs, Shape } from '../types';\r\nexport declare function temporalPadding(x: Tensor, padding?: [number, number]): Tensor;\r\nexport declare function spatial2dPadding(x: Tensor, padding?: [[number, number], [number, number]], dataFormat?: DataFormat): Tensor;\r\nexport interface ZeroPadding2DLayerConfig extends LayerConfig {\r\n    padding?: number | [number, number] | [[number, number], [number, number]];\r\n    dataFormat?: DataFormat;\r\n}\r\nexport declare class ZeroPadding2D extends Layer {\r\n    static className: string;\r\n    readonly dataFormat: DataFormat;\r\n    readonly padding: [[number, number], [number, number]];\r\n    constructor(config?: ZeroPadding2DLayerConfig);\r\n    computeOutputShape(inputShape: Shape | Shape[]): Shape | Shape[];\r\n    call(inputs: Tensor | Tensor[], kwargs: Kwargs): Tensor | Tensor[];\r\n    getConfig(): serialization.ConfigDict;\r\n}\r\n"}}
