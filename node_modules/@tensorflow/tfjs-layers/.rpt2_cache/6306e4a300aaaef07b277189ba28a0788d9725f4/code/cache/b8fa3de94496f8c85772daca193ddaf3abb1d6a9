{"code":"import * as tslib_1 from \"tslib\";\r\nimport { div, keep, mul, tidy } from '@tensorflow/tfjs-core';\r\nimport * as K from './backend/tfjs_backend';\r\nimport * as generic_utils from './utils/generic_utils';\r\nvar Callback = (function () {\r\n    function Callback() {\r\n        this.validationData = null;\r\n        this.model = null;\r\n    }\r\n    Callback.prototype.setParams = function (params) {\r\n        this.params = params;\r\n    };\r\n    Callback.prototype.setModel = function (model) {\r\n        this.model = model;\r\n    };\r\n    Callback.prototype.onEpochBegin = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    Callback.prototype.onEpochEnd = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    Callback.prototype.onBatchBegin = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    Callback.prototype.onBatchEnd = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    Callback.prototype.onTrainBegin = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    Callback.prototype.onTrainEnd = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n            return [2];\r\n        }); });\r\n    };\r\n    return Callback;\r\n}());\r\nexport { Callback };\r\nvar CallbackList = (function () {\r\n    function CallbackList(callbacks, queueLength) {\r\n        if (queueLength === void 0) { queueLength = 10; }\r\n        if (callbacks == null) {\r\n            callbacks = [];\r\n        }\r\n        this.callbacks = callbacks;\r\n        this.queueLength = queueLength;\r\n    }\r\n    CallbackList.prototype.append = function (callback) {\r\n        this.callbacks.push(callback);\r\n    };\r\n    CallbackList.prototype.setParams = function (params) {\r\n        for (var _i = 0, _a = this.callbacks; _i < _a.length; _i++) {\r\n            var callback = _a[_i];\r\n            callback.setParams(params);\r\n        }\r\n    };\r\n    CallbackList.prototype.setModel = function (model) {\r\n        for (var _i = 0, _a = this.callbacks; _i < _a.length; _i++) {\r\n            var callback = _a[_i];\r\n            callback.setModel(model);\r\n        }\r\n    };\r\n    CallbackList.prototype.onEpochBegin = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onEpochBegin(epoch, logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CallbackList.prototype.onEpochEnd = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onEpochEnd(epoch, logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CallbackList.prototype.onBatchBegin = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onBatchBegin(batch, logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CallbackList.prototype.onBatchEnd = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onBatchEnd(batch, logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CallbackList.prototype.onTrainBegin = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onTrainBegin(logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CallbackList.prototype.onTrainEnd = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, callback;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (logs == null) {\r\n                            logs = {};\r\n                        }\r\n                        _i = 0, _a = this.callbacks;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3, 4];\r\n                        callback = _a[_i];\r\n                        return [4, callback.onTrainEnd(logs)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return CallbackList;\r\n}());\r\nexport { CallbackList };\r\nvar BaseLogger = (function (_super) {\r\n    tslib_1.__extends(BaseLogger, _super);\r\n    function BaseLogger() {\r\n        return _super.call(this) || this;\r\n    }\r\n    BaseLogger.prototype.onEpochBegin = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                this.seen = 0;\r\n                this.totals = {};\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    BaseLogger.prototype.onBatchEnd = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            var batchSize, _loop_1, this_1, key;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                if (logs == null) {\r\n                    logs = {};\r\n                }\r\n                batchSize = logs['size'] == null ? 0 : logs['size'];\r\n                this.seen += batchSize;\r\n                _loop_1 = function (key) {\r\n                    var value = logs[key];\r\n                    if (typeof value === 'number') {\r\n                        if (!this_1.totals.hasOwnProperty(key)) {\r\n                            this_1.totals[key] = 0;\r\n                        }\r\n                        this_1.totals[key] = this_1.totals[key] + value * batchSize;\r\n                    }\r\n                    else {\r\n                        if (!this_1.totals.hasOwnProperty(key)) {\r\n                            this_1.totals[key] = K.getScalar(0);\r\n                        }\r\n                        tidy(function () {\r\n                            _this.totals[key] = K.scalarPlusArray(_this.totals[key], mul(value, K.getScalar(batchSize)));\r\n                            keep(_this.totals[key]);\r\n                        });\r\n                    }\r\n                };\r\n                this_1 = this;\r\n                for (key in logs) {\r\n                    _loop_1(key);\r\n                }\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    BaseLogger.prototype.onEpochEnd = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            var _loop_2, this_2, _i, _a, key;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                if (logs != null) {\r\n                    _loop_2 = function (key) {\r\n                        if (this_2.totals[key] == null) {\r\n                            return \"continue\";\r\n                        }\r\n                        if (typeof this_2.totals[key] === 'number') {\r\n                            logs[key] = this_2.totals[key] / this_2.seen;\r\n                        }\r\n                        else {\r\n                            tidy(function () {\r\n                                logs[key] =\r\n                                    K.scalarTimesArray(div(K.getScalar(1), K.getScalar(_this.seen)), _this.totals[key]);\r\n                                _this.totals[key].dispose();\r\n                                keep(logs[key]);\r\n                            });\r\n                        }\r\n                    };\r\n                    this_2 = this;\r\n                    for (_i = 0, _a = this.params['metrics']; _i < _a.length; _i++) {\r\n                        key = _a[_i];\r\n                        _loop_2(key);\r\n                    }\r\n                }\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    return BaseLogger;\r\n}(Callback));\r\nexport { BaseLogger };\r\nexport function resolveScalarsInLogs(logs) {\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        var promises, keys, key, value, valueScalar, values, i;\r\n        return tslib_1.__generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (logs == null) {\r\n                        return [2];\r\n                    }\r\n                    promises = [];\r\n                    keys = [];\r\n                    for (key in logs) {\r\n                        value = logs[key];\r\n                        if (typeof value !== 'number') {\r\n                            valueScalar = value;\r\n                            promises.push(valueScalar.data());\r\n                            keys.push(key);\r\n                        }\r\n                    }\r\n                    return [4, Promise.all(promises)];\r\n                case 1:\r\n                    values = _a.sent();\r\n                    for (i = 0; i < values.length; ++i) {\r\n                        logs[keys[i]] = values[i][0];\r\n                    }\r\n                    return [2];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function disposeTensorsInLogs(logs) {\r\n    if (logs == null) {\r\n        return;\r\n    }\r\n    for (var key in logs) {\r\n        var value = logs[key];\r\n        if (typeof value !== 'number') {\r\n            value.dispose();\r\n        }\r\n    }\r\n}\r\nvar History = (function (_super) {\r\n    tslib_1.__extends(History, _super);\r\n    function History() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    History.prototype.onTrainBegin = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                this.epoch = [];\r\n                this.history = {};\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    History.prototype.onEpochEnd = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var key;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                if (logs == null) {\r\n                    logs = {};\r\n                }\r\n                this.epoch.push(epoch);\r\n                for (key in logs) {\r\n                    if (this.history[key] == null) {\r\n                        this.history[key] = [];\r\n                    }\r\n                    this.history[key].push(logs[key]);\r\n                }\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    History.prototype.syncData = function () {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var promises, keys, indices, key, valueArray, i, valueScalar, values, n;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        keys = [];\r\n                        indices = [];\r\n                        for (key in this.history) {\r\n                            valueArray = this.history[key];\r\n                            for (i = 0; i < valueArray.length; ++i) {\r\n                                if (typeof valueArray[i] !== 'number') {\r\n                                    valueScalar = valueArray[i];\r\n                                    promises.push(valueScalar.data());\r\n                                    keys.push(key);\r\n                                    indices.push(i);\r\n                                }\r\n                            }\r\n                        }\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        values = _a.sent();\r\n                        for (n = 0; n < values.length; ++n) {\r\n                            this.history[keys[n]][indices[n]].dispose();\r\n                            this.history[keys[n]][indices[n]] = values[n][0];\r\n                        }\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return History;\r\n}(Callback));\r\nexport { History };\r\nvar CustomCallback = (function (_super) {\r\n    tslib_1.__extends(CustomCallback, _super);\r\n    function CustomCallback(config) {\r\n        var _this = _super.call(this) || this;\r\n        _this.trainBegin = config.onTrainBegin;\r\n        _this.trainEnd = config.onTrainEnd;\r\n        _this.epochBegin = config.onEpochBegin;\r\n        _this.epochEnd = config.onEpochEnd;\r\n        _this.batchBegin = config.onBatchBegin;\r\n        _this.batchEnd = config.onBatchEnd;\r\n        return _this;\r\n    }\r\n    CustomCallback.prototype.onEpochBegin = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.epochBegin != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.epochBegin(epoch, logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CustomCallback.prototype.onEpochEnd = function (epoch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.epochEnd != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.epochEnd(epoch, logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CustomCallback.prototype.onBatchBegin = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.batchBegin != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.batchBegin(batch, logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CustomCallback.prototype.onBatchEnd = function (batch, logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.batchEnd != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.batchEnd(batch, logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CustomCallback.prototype.onTrainBegin = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.trainBegin != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.trainBegin(logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CustomCallback.prototype.onTrainEnd = function (logs) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.trainEnd != null)) return [3, 3];\r\n                        return [4, resolveScalarsInLogs(logs)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4, this.trainEnd(logs)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return CustomCallback;\r\n}(Callback));\r\nexport { CustomCallback };\r\nexport function standardizeCallbacks(callbacks) {\r\n    if (callbacks == null) {\r\n        return null;\r\n    }\r\n    if (callbacks instanceof Callback) {\r\n        return [callbacks];\r\n    }\r\n    if (Array.isArray(callbacks) && callbacks[0] instanceof Callback) {\r\n        return callbacks;\r\n    }\r\n    var callbackConfigs = generic_utils.toList(callbacks);\r\n    return callbackConfigs.map(function (callbackConfig) { return new CustomCallback(callbackConfig); });\r\n}\r\n//# sourceMappingURL=callbacks.js.map","map":"{\"version\":3,\"file\":\"callbacks.js\",\"sourceRoot\":\"\",\"sources\":[\"src/callbacks.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/usr/local/google/home/smilkov/code/tfjs-layers/callbacks.d.ts","text":"import { Scalar, Tensor } from '@tensorflow/tfjs-core';\r\nimport { Model } from './engine/training';\r\nexport declare type UnresolvedLogs = {\r\n    [key: string]: number | Scalar;\r\n};\r\nexport declare type Logs = {\r\n    [key: string]: number;\r\n};\r\nexport declare type Params = {\r\n    [key: string]: number | string | boolean | number[] | string[] | boolean[];\r\n};\r\nexport declare abstract class Callback {\r\n    validationData: Tensor | Tensor[];\r\n    model: Model;\r\n    params: Params;\r\n    setParams(params: Params): void;\r\n    setModel(model: Model): void;\r\n    onEpochBegin(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onEpochEnd(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchBegin(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchEnd(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainBegin(logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainEnd(logs?: UnresolvedLogs): Promise<void>;\r\n}\r\nexport declare class CallbackList {\r\n    callbacks: Callback[];\r\n    queueLength: number;\r\n    constructor(callbacks?: Callback[], queueLength?: number);\r\n    append(callback: Callback): void;\r\n    setParams(params: Params): void;\r\n    setModel(model: Model): void;\r\n    onEpochBegin(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onEpochEnd(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchBegin(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchEnd(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainBegin(logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainEnd(logs?: UnresolvedLogs): Promise<void>;\r\n}\r\nexport declare class BaseLogger extends Callback {\r\n    private seen;\r\n    private totals;\r\n    constructor();\r\n    onEpochBegin(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchEnd(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onEpochEnd(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n}\r\nexport declare function resolveScalarsInLogs(logs: UnresolvedLogs): Promise<void>;\r\nexport declare function disposeTensorsInLogs(logs: UnresolvedLogs): void;\r\nexport declare class History extends Callback {\r\n    epoch: number[];\r\n    history: {\r\n        [key: string]: Array<number | Tensor>;\r\n    };\r\n    onTrainBegin(logs?: UnresolvedLogs): Promise<void>;\r\n    onEpochEnd(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    syncData(): Promise<void>;\r\n}\r\nexport interface CustomCallbackConfig {\r\n    onTrainBegin?: (logs?: Logs) => Promise<void>;\r\n    onTrainEnd?: (logs?: Logs) => Promise<void>;\r\n    onEpochBegin?: (epoch: number, logs?: Logs) => Promise<void>;\r\n    onEpochEnd?: (epoch: number, logs?: Logs) => Promise<void>;\r\n    onBatchBegin?: (batch: number, logs?: Logs) => Promise<void>;\r\n    onBatchEnd?: (batch: number, logs?: Logs) => Promise<void>;\r\n}\r\nexport declare class CustomCallback extends Callback {\r\n    protected readonly trainBegin: (logs?: Logs) => Promise<void>;\r\n    protected readonly trainEnd: (logs?: Logs) => Promise<void>;\r\n    protected readonly epochBegin: (epoch: number, logs?: Logs) => Promise<void>;\r\n    protected readonly epochEnd: (epoch: number, logs?: Logs) => Promise<void>;\r\n    protected readonly batchBegin: (batch: number, logs?: Logs) => Promise<void>;\r\n    protected readonly batchEnd: (batch: number, logs?: Logs) => Promise<void>;\r\n    constructor(config: CustomCallbackConfig);\r\n    onEpochBegin(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onEpochEnd(epoch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchBegin(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onBatchEnd(batch: number, logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainBegin(logs?: UnresolvedLogs): Promise<void>;\r\n    onTrainEnd(logs?: UnresolvedLogs): Promise<void>;\r\n}\r\nexport declare function standardizeCallbacks(callbacks: Callback | Callback[] | CustomCallbackConfig | CustomCallbackConfig[]): Callback[];\r\n"}}
